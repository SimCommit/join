<section class="contact-detail">
  <div class="head">
    <h1>Contacts</h1>
    <div class="spacer-blue"></div>
    <span class="tagline">Better with a team</span>
  </div>

  @if (contact$ | async; as contact) {
  <div class="contact-details-content" [class.animateContent]="animated">
    <div class="contact-name">
      <div class="contact-icon" [style.background-color]="getRandomColor(contact.name)">
        {{ contactDataService.extractInitials(contact.name) }}
      </div>
      <div class="contact-info-section">
        <h2 title="{{ contact.name }}">{{ contact.name }}</h2>
        <div class="contact-actions">
          <button class="action-btn edit-btn" (click)="editContact(contact)" title="Kontakt bearbeiten">
            <div class="icon-edit"></div>
            <span>Edit</span>
          </button>
          @if (!(isOwnContact$ | async)) {
          <button class="action-btn delete-btn" (click)="contact.id && deleteContact(contact.id)">
            <div class="icon-delete"></div>
            <span>Delete</span>
          </button>
          }
        </div>
      </div>
    </div>

    <div class="contact-header">
      <h3>Contact Information</h3>
    </div>

    <address class="contact-info">
      <div class="info-item">
        <span class="label">Email</span>
        <a href="mailto:{{ contact.email }}">{{ contact.email }}</a>
      </div>

      @if (contact.phone) {
      <div class="info-item">
        <span class="label">Phone</span>
        <a href="tel:{{ contact.phone }}">{{ contact.phone }}</a>
      </div>
      }
    </address>
  </div>

  <button class="mobile-menu-fab" (click)="toggleMobileMenu()" title="Options">
    <div class="three-dots">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  </button>

  @if (showMobileMenu) {
  <div class="mobile-menu-overlay" (click)="closeMobileMenu()">
    <div class="mobile-menu-content" (click)="$event.stopPropagation()">
      <button class="mobile-menu-item edit-item" (click)="editContact(contact)" title="Edit Contact">
        <div class="icon-edit"></div>
        <span>Edit</span>
      </button>
      <button class="mobile-menu-item delete-item" (click)="contact.id && deleteContact(contact.id)"
        title="Delete Contact">
        <div class="icon-delete"></div>
        <span>Delete</span>
      </button>
    </div>
  </div>
  }
  } @else {
  @if (isMobileView) {
  <div class="mobile-header">
    <button (click)="goBack()" class="mobile-back-arrow">
      <img src="img/icons/arrow-left-line.svg" alt="Back" />
    </button>
  </div>
  <p>No contact selected</p>
  }
  }
</section>

@if (showEditDialog) {
<app-contact-dialog [editingContact]="contactToEdit" [shouldClose]="shouldCloseDialog"
  (closeRequested)="startDialogClose()" (closeCanceled)="shouldCloseDialog = false" (dialogClosed)="closeDialog()"
  (contactSubmitted)="onContactSubmitted($event)">
</app-contact-dialog>
}