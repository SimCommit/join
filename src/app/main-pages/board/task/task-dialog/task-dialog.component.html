<div class="dialog-overlay" (click)="closeDialog()" cdkTrapFocus>
  <dialog class="dialog-content" (click)="$event.stopPropagation()">
    <div class="dialog-header">
      <div class="task-category-badge" [ngClass]="task?.category === 'User Story' ? 'user-story' : 'technical-task'">
        {{ task?.category }}
      </div>
      <button class="close-btn" (click)="closeDialog()">
        <img src="./img/icons/close-button.svg" alt="">
      </button>
    </div>

    <div class="dialog-body">
      @if (!isEditMode) {
      <app-task-details [task]="task" (editClicked)="onEditClicked()" (deleteClicked)="onDeleteClicked($event)"
        (subtaskToggled)="onSubtaskToggled($event)">
      </app-task-details>
      } @else {
      <app-task-edit-form [task]="task" (saveClicked)="onSaveClicked($event)" (validationChange)="checkValidationState($event)" (cancelClicked)="onCancelClicked()">
      </app-task-edit-form>
      }
    </div>

    @if (isEditMode) {
    <div class="dialog-footer">
      <button class="action-btn cancel-btn" (click)="onCancelClicked()">
        <span>Cancel</span>
      </button>
      <button class="action-btn save-btn" (click)="onSaveButtonClicked()" [disabled]="!taskEditFormIsValid">
        <span>Ok</span>
      </button>
    </div>
    }
  </dialog>
</div>